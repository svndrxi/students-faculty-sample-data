<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Sample Borrower Data</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 700px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: #666;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            color: #667eea;
        }

        .tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .info-box p {
            color: #555;
            font-size: 13px;
            line-height: 1.6;
            margin: 5px 0;
        }

        .info-box code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            color: #d63384;
        }

        .controls {
            margin-bottom: 25px;
        }

        label {
            display: block;
            color: #555;
            font-weight: 600;
            margin-bottom: 8px;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .preview {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .preview h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .sample-table {
            width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f9fa;
            color: #667eea;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Borrower Data Generator</h1>
        <p class="subtitle">Generate sample student and faculty data for testing your import feature</p>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('students')">üë®‚Äçüéì Students</button>
            <button class="tab-btn" onclick="switchTab('faculty')">üë®‚Äçüè´ Faculty</button>
        </div>

        <!-- Students Tab -->
        <div id="students-content" class="tab-content active">
            <div class="info-box">
                <h3>Excel Format - Students</h3>
                <p><strong>Columns:</strong></p>
                <p><code>id_number</code>, <code>first_name</code>, <code>last_name</code>, <code>year</code>, <code>program</code>, <code>department</code>, <code>email</code>, <code>contact_number</code></p>
            </div>

            <div class="controls">
                <label for="studentCount">Number of Student Records:</label>
                <input type="number" id="studentCount" min="1" max="500" value="50">
            </div>

            <button class="btn" onclick="generateAndDownload('students')">
                ‚¨áÔ∏è Generate & Download Student Data
            </button>

            <div class="preview">
                <h3>Preview (First 5 Records)</h3>
                <div class="sample-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ID Number</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Year</th>
                                <th>Program</th>
                            </tr>
                        </thead>
                        <tbody id="studentPreview">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Faculty Tab -->
        <div id="faculty-content" class="tab-content">
            <div class="info-box">
                <h3>Excel Format - Faculty</h3>
                <p><strong>Columns:</strong></p>
                <p><code>id_number</code>, <code>first_name</code>, <code>last_name</code>, <code>department</code>, <code>email</code>, <code>contact_number</code></p>
            </div>

            <div class="controls">
                <label for="facultyCount">Number of Faculty Records:</label>
                <input type="number" id="facultyCount" min="1" max="500" value="50">
            </div>

            <button class="btn" onclick="generateAndDownload('faculty')">
                ‚¨áÔ∏è Generate & Download Faculty Data
            </button>

            <div class="preview">
                <h3>Preview (First 5 Records)</h3>
                <div class="sample-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Employee No.</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Department</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody id="facultyPreview">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="success-message" id="successMessage">
            ‚úÖ File generated successfully! Check your downloads.
        </div>
    </div>

    <script>
        const firstNames = [
            'Juan', 'Maria', 'Jose', 'Ana', 'Miguel', 'Sofia', 'Gabriel', 'Isabella',
            'Carlos', 'Camila', 'Diego', 'Valentina', 'Luis', 'Mariana', 'Pedro',
            'Lucia', 'Rafael', 'Carmen', 'Fernando', 'Rosa', 'Antonio', 'Elena',
            'Manuel', 'Patricia', 'Ricardo', 'Teresa', 'Roberto', 'Angela', 'Eduardo',
            'Gloria', 'Francisco', 'Diana', 'Javier', 'Laura', 'Ramon', 'Monica',
            'Sergio', 'Beatriz', 'Alberto', 'Sandra', 'Alejandro', 'Cristina',
            'Jorge', 'Martha', 'Daniel', 'Silvia', 'Andres', 'Veronica', 'Pablo', 'Natalia'
        ];

        const lastNames = [
            'Garcia', 'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Perez',
            'Sanchez', 'Ramirez', 'Torres', 'Flores', 'Rivera', 'Gomez', 'Diaz',
            'Cruz', 'Morales', 'Reyes', 'Gutierrez', 'Ortiz', 'Chavez', 'Ramos',
            'Castillo', 'Mendoza', 'Ruiz', 'Vasquez', 'Jimenez', 'Moreno', 'Romero',
            'Alvarez', 'Medina', 'Aguilar', 'Santos', 'Dela Cruz', 'Bautista', 'Villanueva',
            'Aquino', 'Santiago', 'Domingo', 'Castro', 'Mercado', 'Fernandez', 'Salazar'
        ];

        const programs = ['BSIT', 'BSCS', 'BSIS', 'ACT'];
        const departments = ['IT Department', 'CS Department', 'IS Department', 'Administration'];
        const titles = ['Prof.', 'Dr.', 'Mr.', 'Ms.', 'Mrs.'];

        function generateStudentData(count) {
            const data = [];
            const currentYear = new Date().getFullYear();
            
            for (let i = 1; i <= count; i++) {
                const year = Math.floor(Math.random() * 4) + 1;
                const program = programs[Math.floor(Math.random() * programs.length)];
                const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
                const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
                const idNumber = `${currentYear - year + 1}-${String(i).padStart(4, '0')}`;
                const email = `${firstName.toLowerCase()}.${lastName.toLowerCase()}@student.fcpc.edu.ph`;
                const contactNumber = `09${Math.floor(Math.random() * 900000000 + 100000000)}`;
                
                let department;
                if (program === 'BSIT') department = 'IT Department';
                else if (program === 'BSCS') department = 'CS Department';
                else if (program === 'BSIS') department = 'IS Department';
                else department = departments[Math.floor(Math.random() * departments.length)];

                data.push({
                    id_number: idNumber,
                    first_name: firstName,
                    last_name: lastName,
                    year: year.toString(),
                    program: program,
                    department: department,
                    email: email,
                    contact_number: contactNumber
                });
            }
            
            return data;
        }

        function generateFacultyData(count) {
            const data = [];
            const currentYear = new Date().getFullYear();
            
            for (let i = 1; i <= count; i++) {
                const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
                const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
                const department = departments[Math.floor(Math.random() * departments.length)];
                const idNumber = `EMP-${currentYear}-${String(i).padStart(4, '0')}`;
                const email = `${firstName.toLowerCase()}.${lastName.toLowerCase()}@fcpc.edu.ph`;
                const contactNumber = `09${Math.floor(Math.random() * 900000000 + 100000000)}`;

                data.push({
                    id_number: idNumber,
                    first_name: firstName,
                    last_name: lastName,
                    department: department,
                    email: email,
                    contact_number: contactNumber
                });
            }
            
            return data;
        }

        function switchTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tab}-content`).classList.add('active');

            // Update preview
            updatePreview(tab);
        }

        function updatePreview(type) {
            let data, tbody;
            
            if (type === 'students') {
                data = generateStudentData(5);
                tbody = document.getElementById('studentPreview');
                tbody.innerHTML = '';
                
                data.forEach(student => {
                    const row = tbody.insertRow();
                    row.innerHTML = `
                        <td>${student.id_number}</td>
                        <td>${student.first_name}</td>
                        <td>${student.last_name}</td>
                        <td>${student.year}</td>
                        <td>${student.program}</td>
                    `;
                });
            } else {
                data = generateFacultyData(5);
                tbody = document.getElementById('facultyPreview');
                tbody.innerHTML = '';
                
                data.forEach(faculty => {
                    const row = tbody.insertRow();
                    row.innerHTML = `
                        <td>${faculty.id_number}</td>
                        <td>${faculty.first_name}</td>
                        <td>${faculty.last_name}</td>
                        <td>${faculty.department}</td>
                        <td>${faculty.email}</td>
                    `;
                });
            }
        }

        function generateAndDownload(type) {
            let count, data, ws_data, filename;
            
            if (type === 'students') {
                count = parseInt(document.getElementById('studentCount').value);
                
                if (count < 1 || count > 500) {
                    alert('Please enter a number between 1 and 500');
                    return;
                }

                data = generateStudentData(count);
                
                ws_data = [
                    ['id_number', 'first_name', 'last_name', 'year', 'program', 'department', 'email', 'contact_number']
                ];
                
                data.forEach(student => {
                    ws_data.push([
                        student.id_number,
                        student.first_name,
                        student.last_name,
                        student.year,
                        student.program,
                        student.department,
                        student.email,
                        student.contact_number
                    ]);
                });
                
                filename = `sample_students_${count}.xlsx`;
                
            } else {
                count = parseInt(document.getElementById('facultyCount').value);
                
                if (count < 1 || count > 500) {
                    alert('Please enter a number between 1 and 500');
                    return;
                }

                data = generateFacultyData(count);
                
                ws_data = [
                    ['id_number', 'first_name', 'last_name', 'department', 'email', 'contact_number']
                ];
                
                data.forEach(faculty => {
                    ws_data.push([
                        faculty.id_number,
                        faculty.first_name,
                        faculty.last_name,
                        faculty.department,
                        faculty.email,
                        faculty.contact_number
                    ]);
                });
                
                filename = `sample_faculty_${count}.xlsx`;
            }
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            
            // Set column widths
            if (type === 'students') {
                ws['!cols'] = [
                    {wch: 15}, {wch: 15}, {wch: 15}, {wch: 8},
                    {wch: 10}, {wch: 20}, {wch: 35}, {wch: 15}
                ];
            } else {
                ws['!cols'] = [
                    {wch: 20}, {wch: 15}, {wch: 15}, {wch: 20},
                    {wch: 35}, {wch: 15}
                ];
            }
            
            XLSX.utils.book_append_sheet(wb, ws, type === 'students' ? 'Students' : 'Faculty');
            XLSX.writeFile(wb, filename);
            
            // Show success message
            const successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
        }

        // Initialize preview
        updatePreview('students');

        // Update preview when count changes
        document.getElementById('studentCount').addEventListener('input', () => updatePreview('students'));
        document.getElementById('facultyCount').addEventListener('input', () => updatePreview('faculty'));
    </script>
</body>
</html>
